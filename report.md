Отчёт по выполнению  проекта «Предсказание стоимости автомобилей».
1. Что было сделано
1.1. Исследовательский анализ данных (EDA)

-Загрузка датасетов cars_train.csv и cars_test.csv.

-Просмотр структуры данных, типов признаков, базовых статистик.

-Поиск пропусков, выбросов, дубликатов.

-Анализ распределений числовых признаков (гистограммы, KDE).

-Корреляционный анализ — построена матрица корреляций.

Выводы:

В данных присутствуют строковые значения с единицами измерения ("14.5 kmpl", "1197 CC", "67 bhp"), которые не подходят для модели.

Имеется много пропусков в столбцах mileage, engine, max_power, torque, seats.

В выборке есть дубликаты — более 1700 наблюдений с совпадающими признаками.

Распределения train и test схожи, что позволяет обучать модель корректно.

2. Предобработка данных
2.1. Очистка строковых признаков

Были извлечены числовые значения из признаков:

mileage: "18.6 kmpl" → 18.6

engine: "1197 CC" → 1197

max_power: "81.86 bhp" → 81.86

torque: невозможно преобразовать корректно → признак удалён

2.2. Обработка пропусков

Числовые признаки заполнялись медианами train, чтобы не допустить утечку информации.

Категориальные признаков пропусков не содержали.

2.3. Удаление дубликатов

Было найдено 1799 полностью дублирующих объектов, удалены.

2.4. Генерация новых признаков

Добавлен признак:

name_word_count — число слов в названии автомобиля.

2.5. Кодирование категориальных признаков

Использована OneHotEncoder(drop="first") для признаков:

fuel

seller_type

transmission

owner

seats

Финальная обучающая матрица — около 25 признаков.

3. Обучение моделей и сравнение

Были обучены:

3.1. Linear Regression

Простая линейная модель на OHE-признаках

R² test ≈ 0.59

3.2. Ridge Regression

Подбор гиперпараметра alpha через GridSearchCV

Лучшее alpha = 10

R² test ≈ 0.62

3.3. Lasso Regression

L1-регуляризация

Оптимальный параметр alpha = 100

Коэффициенты многих признаков занула

R² test ≈ 0.55

3.4. ElasticNet

Совмещает L1 и L2-регуляризацию

GridSearchCV по сетке alpha × l1_ratio

Лучшие параметры:

alpha = 1

l1_ratio = 0.9

R² test ≈ 0.576

3.5. Бизнес-метрика (точность ±10%)

Модели оценивались по условию: предсказание считается точным,
если ошибается не более чем на 10%.

Модель	Бизнес-метрика
LinearRegression	0.2470
Ridge	0.2450
Lasso	0.2270
ElasticNet	0.2540 (лучший)

Итог: лучшая модель — ElasticNet.

4. Что дало наибольший прирост качества

OneHotEncoding категориальных признаков — критично важно.
Без него качество падает почти вдвое.

Удаление аномальных строковых значений и извлечение чисел
— модель получает корректные числовые данные.

Удаление дубликатов улучшило обобщающую способность.

Использование ElasticNet
— позволило успешно регуляризовать модель, ограничив переобучение.

5. Что сделать не удалось

Не удалось добиться высокого R² (>0.75)
Это объясняется особой природой данных:

цена автомобиля зависит от множества скрытых факторов
(состояние, ДТП, регион, комплектация), которых нет в датасете.

Признак torque невозможно адекватно преобразовать → удалён.

Невозможно идеально объяснить большие расхождения в цене
— часть машин имеет нестандартные комплектации или состояние.

6. Оценка Streamlit-сервиса
6.1. Удобство использования

Приложение включает:

Загрузку CSV для EDA

Визуализации гистограмм

Полный цикл инференса: загрузка → препроцессинг → предсказание

Ручной ввод автомобиля

Отображение коэффициентов модели

Сервис получился функциональным и понятным для пользователя.

6.2. Хорошо реализованные элементы

Грамотное разделение вкладок (EDA / Prediction / Model Weights)

Корректная обработка пользовательского ввода

Возможность скачать результаты

Понятные визуализации распределений признаков

6.3. Менее удачные моменты

Модель отличается большой ошибкой на дорогих автомобилях

Некоторые графики EDA могут выглядеть «захламлёнными»

Нет интерактивных фильтров или zoom для графиков

6.4. Ограничения

Линейная модель плохо предсказывает дорогие машины

Недостаток важных признаков (Состояние, Город, Комплектация, Пробег по трассе/городу)

Модель не использует NLP-информацию из названия автомобиля

6.5. Пути улучшения

Добавить градиентный бустинг (CatBoost / XGBoost)

Использовать TF-IDF анализ названия автомобиля

Ввести больше статистических признаков

Улучшить обработку пропусков

Добавить визуализации BoxPlot и ScatterPlot

Реализовать системный лог ошибок

Развернуть полноценный backend через FastAPI

7. Итог

Построен полный пайплайн: EDA → preprocessing → обучение → выбор лучшей модели → сервис

Лучшая модель: ElasticNet(alpha=1, l1_ratio=0.9)

Создано полноценное Streamlit-приложение

Репозиторий оформлен, все pickle/JSON и app.py загружены

Данные преобразованы и сохранены в train_clean.csv / test_clean.csv
